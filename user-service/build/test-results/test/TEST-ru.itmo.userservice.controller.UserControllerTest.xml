<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="User Controller Tests" tests="20" skipped="0" failures="4" errors="0" timestamp="2025-12-24T06:24:18.157Z" hostname="MacBook-Pro-Anastasia-6.local" time="4.128">
  <properties/>
  <testcase name="PUT /api/users/me - Should return 404 for non-existent user" classname="ru.itmo.userservice.controller.UserControllerTest" time="1.621"/>
  <testcase name="GET /api/users/me - Should get current user" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.645"/>
  <testcase name="GET /api/users/me - Should return 400 for invalid user ID" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.053"/>
  <testcase name="POST /api/users/register - Should register user" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.195"/>
  <testcase name="POST /api/users/register - Should return 409 for duplicate username" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.148">
    <failure message="java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;" type="java.lang.AssertionError">java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$isEqualTo$0(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:61)
	at ru.itmo.userservice.controller.UserControllerTest.testRegisterDuplicateUsername(UserControllerTest.kt:141)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</failure>
  </testcase>
  <testcase name="GET /api/users/me - Should return 404 for non-existent user" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.048"/>
  <testcase name="PUT /api/users/me - Should update profile with partial data" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.166"/>
  <testcase name="PUT /api/users/me - Should update user profile" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.141"/>
  <testcase name="POST /api/users/register - Should return 409 for duplicate email" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.196">
    <failure message="java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;" type="java.lang.AssertionError">java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$isEqualTo$0(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:61)
	at ru.itmo.userservice.controller.UserControllerTest.testRegisterDuplicateEmail(UserControllerTest.kt:169)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</failure>
  </testcase>
  <testcase name="PUT /api/users/me - Should return 400 for invalid user ID" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.12"/>
  <testcase name="PUT /api/users/me - Should return 409 for duplicate email" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.158">
    <failure message="java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;" type="java.lang.AssertionError">java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$isEqualTo$0(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:61)
	at ru.itmo.userservice.controller.UserControllerTest.testUpdateProfileDuplicateEmail(UserControllerTest.kt:384)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</failure>
  </testcase>
  <testcase name="GET /api/users/username/{username} - Should get user by username" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.143"/>
  <testcase name="POST /api/users/register - Should return 400 for short password" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.046">
    <failure message="java.lang.AssertionError: Status expected:&lt;400 BAD_REQUEST&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;" type="java.lang.AssertionError">java.lang.AssertionError: Status expected:&lt;400 BAD_REQUEST&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$assertStatusAndReturn$4(StatusAssertions.java:236)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.assertStatusAndReturn(StatusAssertions.java:236)
	at org.springframework.test.web.reactive.server.StatusAssertions.isBadRequest(StatusAssertions.java:131)
	at ru.itmo.userservice.controller.UserControllerTest.testRegisterShortPassword(UserControllerTest.kt:188)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</failure>
  </testcase>
  <testcase name="DELETE /api/users/{userId} - Should delete user" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.107"/>
  <testcase name="GET /api/users/{userId} - Should get user by ID" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.086"/>
  <testcase name="GET /api/users/username/{username} - Should return 404 for non-existent username" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.034"/>
  <testcase name="GET /api/users/{userId} - Should return 404 for non-existent user" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.03"/>
  <testcase name="GET /api/users/{userId} - Should return 400 for invalid user ID" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.028"/>
  <testcase name="DELETE /api/users/{userId} - Should return 404 for non-existent user" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.054"/>
  <testcase name="DELETE /api/users/{userId} - Should return 400 for invalid user ID" classname="ru.itmo.userservice.controller.UserControllerTest" time="0.04"/>
  <system-out><![CDATA[
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.7)

2025-12-24T09:24:13.594+03:00  INFO 96902 --- [user-service] [    Test worker] r.i.u.controller.UserControllerTest      : The following 1 profile is active: "test"
2025-12-24T09:24:17.457+03:00  WARN 96902 --- [user-service] [    Test worker] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
2025-12-24T09:24:18.123+03:00  INFO 96902 --- [user-service] [    Test worker] r.i.u.controller.UserControllerTest      : Started UserControllerTest in 5.174 seconds (process running for 43.042)
2025-12-24T09:24:18.130+03:00  WARN 96902 --- [user-service] [    Test worker] o.s.core.events.SpringDocAppInitializer  : SpringDoc /v3/api-docs endpoint is enabled by default. To disable it in production, set the property 'springdoc.api-docs.enabled=false'
2025-12-24T09:24:18.130+03:00  WARN 96902 --- [user-service] [    Test worker] o.s.core.events.SpringDocAppInitializer  : SpringDoc /swagger-ui.html endpoint is enabled by default. To disable it in production, set the property 'springdoc.swagger-ui.enabled=false'
2025-12-24T09:24:20.826+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

> POST /api/users/register
> WebTestClient-Request-Id: [6]
> Content-Type: [application/json]
> Content-Length: [113]

{"username":"testuser","email":"test2@example.com","password":"Password123","firstName":"Test","lastName":"User"}

< 500 INTERNAL_SERVER_ERROR Internal Server Error
< Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
< Content-Type: [application/json]
< Content-Length: [124]

{"message":"Username already taken: testuser","status":500,"timestamp":"2025-12-24T09:24:20.799792","path":"","errors":null}

2025-12-24T09:24:21.389+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

> POST /api/users/register
> WebTestClient-Request-Id: [11]
> Content-Type: [application/json]
> Content-Length: [113]

{"username":"testuser2","email":"test@example.com","password":"Password123","firstName":"Test","lastName":"User"}

< 500 INTERNAL_SERVER_ERROR Internal Server Error
< Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
< Content-Type: [application/json]
< Content-Length: [134]

{"message":"Email already registered: test@example.com","status":500,"timestamp":"2025-12-24T09:24:21.380996","path":"","errors":null}

2025-12-24T09:24:21.692+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

> PUT /api/users/me?userId=8
> WebTestClient-Request-Id: [13]
> Content-Type: [application/json]
> Content-Length: [62]

{"email":"test1@example.com","firstName":null,"lastName":null}

< 500 INTERNAL_SERVER_ERROR Internal Server Error
< Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
< Content-Type: [application/json]
< Content-Length: [134]

{"message":"Email already registered: test1@example.com","status":500,"timestamp":"2025-12-24T09:24:21.68989","path":"","errors":null}

2025-12-24T09:24:21.885+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

> POST /api/users/register
> WebTestClient-Request-Id: [15]
> Content-Type: [application/json]
> Content-Length: [106]

{"username":"testuser","email":"test@example.com","password":"short","firstName":"Test","lastName":"User"}

< 500 INTERNAL_SERVER_ERROR Internal Server Error
< Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
< Content-Type: [application/json]
< Content-Length: [802]

{"message":"Validation failed for argument at index 0 in method: public reactor.core.publisher.Mono<org.springframework.http.ResponseEntity<ru.itmo.userservice.model.dto.response.UserResponse>> ru.itmo.userservice.controller.UserController.register(ru.itmo.userservice.model.dto.request.RegisterRequest), with 1 error(s): [Field error in object 'registerRequest' on field 'password': rejected value [short]; codes [Size.registerRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.password,password]; arguments []; default message [password],72,8]; default message [Password must be between 8 and 72 characters]] ","status":500,"timestamp":"2025-12-24T09:24:21.882881","path":"","errors":null}

]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
