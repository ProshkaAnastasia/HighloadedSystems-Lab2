<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"/>
<title>Test results - User Controller Tests</title>
<link href="../css/base-style.css" rel="stylesheet" type="text/css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<script src="../js/report.js" type="text/javascript"></script>
</head>
<body>
<div id="content">
<h1>User Controller Tests</h1>
<div class="breadcrumbs">
<a href="../index.html">all</a> &gt; 
<a href="../packages/ru.itmo.userservice.controller.html">ru.itmo.userservice.controller</a> &gt; UserControllerTest</div>
<div id="summary">
<table>
<tr>
<td>
<div class="summaryGroup">
<table>
<tr>
<td>
<div class="infoBox" id="tests">
<div class="counter">20</div>
<p>tests</p>
</div>
</td>
<td>
<div class="infoBox" id="failures">
<div class="counter">4</div>
<p>failures</p>
</div>
</td>
<td>
<div class="infoBox" id="ignored">
<div class="counter">0</div>
<p>ignored</p>
</div>
</td>
<td>
<div class="infoBox" id="duration">
<div class="counter">4.059s</div>
<p>duration</p>
</div>
</td>
</tr>
</table>
</div>
</td>
<td>
<div class="infoBox failures" id="successRate">
<div class="percent">80%</div>
<p>successful</p>
</div>
</td>
</tr>
</table>
</div>
<div class="tab-container">
<ul class="tabLinks">
<li>
<a href="#">Failed tests</a>
</li>
<li>
<a href="#">Tests</a>
</li>
<li>
<a href="#">Standard output</a>
</li>
</ul>
<div class="tab">
<h2>Failed tests</h2>
<div class="test">
<a name="testRegisterDuplicateEmail()"></a>
<h3 class="failures">POST /api/users/register - Should return 409 for duplicate email</h3>
<span class="code">
<pre>java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$isEqualTo$0(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:61)
	at ru.itmo.userservice.controller.UserControllerTest.testRegisterDuplicateEmail(UserControllerTest.kt:169)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</pre>
</span>
</div>
<div class="test">
<a name="testRegisterDuplicateUsername()"></a>
<h3 class="failures">POST /api/users/register - Should return 409 for duplicate username</h3>
<span class="code">
<pre>java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$isEqualTo$0(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:61)
	at ru.itmo.userservice.controller.UserControllerTest.testRegisterDuplicateUsername(UserControllerTest.kt:141)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</pre>
</span>
</div>
<div class="test">
<a name="testRegisterShortPassword()"></a>
<h3 class="failures">POST /api/users/register - Should return 400 for short password</h3>
<span class="code">
<pre>java.lang.AssertionError: Status expected:&lt;400 BAD_REQUEST&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$assertStatusAndReturn$4(StatusAssertions.java:236)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.assertStatusAndReturn(StatusAssertions.java:236)
	at org.springframework.test.web.reactive.server.StatusAssertions.isBadRequest(StatusAssertions.java:131)
	at ru.itmo.userservice.controller.UserControllerTest.testRegisterShortPassword(UserControllerTest.kt:188)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</pre>
</span>
</div>
<div class="test">
<a name="testUpdateProfileDuplicateEmail()"></a>
<h3 class="failures">PUT /api/users/me - Should return 409 for duplicate email</h3>
<span class="code">
<pre>java.lang.AssertionError: Status expected:&lt;409 CONFLICT&gt; but was:&lt;500 INTERNAL_SERVER_ERROR&gt;
	at org.springframework.test.util.AssertionErrors.fail(AssertionErrors.java:61)
	at org.springframework.test.util.AssertionErrors.assertEquals(AssertionErrors.java:128)
	at org.springframework.test.web.reactive.server.StatusAssertions.lambda$isEqualTo$0(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.ExchangeResult.assertWithDiagnostics(ExchangeResult.java:232)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:53)
	at org.springframework.test.web.reactive.server.StatusAssertions.isEqualTo(StatusAssertions.java:61)
	at ru.itmo.userservice.controller.UserControllerTest.testUpdateProfileDuplicateEmail(UserControllerTest.kt:384)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
</pre>
</span>
</div>
</div>
<div class="tab">
<h2>Tests</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Method name</th>
<th>Duration</th>
<th>Result</th>
</tr>
</thead>
<tr>
<td class="success">DELETE /api/users/{userId} - Should delete user</td>
<td class="success">testDeleteUser()</td>
<td class="success">0.107s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">DELETE /api/users/{userId} - Should return 400 for invalid user ID</td>
<td class="success">testDeleteUserInvalidId()</td>
<td class="success">0.040s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">DELETE /api/users/{userId} - Should return 404 for non-existent user</td>
<td class="success">testDeleteUserNotFound()</td>
<td class="success">0.054s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/me - Should get current user</td>
<td class="success">testGetCurrentUser()</td>
<td class="success">0.645s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/me - Should return 400 for invalid user ID</td>
<td class="success">testGetCurrentUserInvalidId()</td>
<td class="success">0.053s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/me - Should return 404 for non-existent user</td>
<td class="success">testGetCurrentUserNotFound()</td>
<td class="success">0.048s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/{userId} - Should get user by ID</td>
<td class="success">testGetUserById()</td>
<td class="success">0.086s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/{userId} - Should return 404 for non-existent user</td>
<td class="success">testGetUserByIdNotFound()</td>
<td class="success">0.030s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/{userId} - Should return 400 for invalid user ID</td>
<td class="success">testGetUserByInvalidId()</td>
<td class="success">0.028s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/username/{username} - Should get user by username</td>
<td class="success">testGetUserByUsername()</td>
<td class="success">0.143s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">GET /api/users/username/{username} - Should return 404 for non-existent username</td>
<td class="success">testGetUserByUsernameNotFound()</td>
<td class="success">0.034s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="failures">POST /api/users/register - Should return 409 for duplicate email</td>
<td class="failures">testRegisterDuplicateEmail()</td>
<td class="failures">0.196s</td>
<td class="failures">failed</td>
</tr>
<tr>
<td class="failures">POST /api/users/register - Should return 409 for duplicate username</td>
<td class="failures">testRegisterDuplicateUsername()</td>
<td class="failures">0.148s</td>
<td class="failures">failed</td>
</tr>
<tr>
<td class="failures">POST /api/users/register - Should return 400 for short password</td>
<td class="failures">testRegisterShortPassword()</td>
<td class="failures">0.046s</td>
<td class="failures">failed</td>
</tr>
<tr>
<td class="success">POST /api/users/register - Should register user</td>
<td class="success">testRegisterUser()</td>
<td class="success">0.195s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">PUT /api/users/me - Should update user profile</td>
<td class="success">testUpdateProfile()</td>
<td class="success">0.141s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="failures">PUT /api/users/me - Should return 409 for duplicate email</td>
<td class="failures">testUpdateProfileDuplicateEmail()</td>
<td class="failures">0.158s</td>
<td class="failures">failed</td>
</tr>
<tr>
<td class="success">PUT /api/users/me - Should return 400 for invalid user ID</td>
<td class="success">testUpdateProfileInvalidId()</td>
<td class="success">0.120s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">PUT /api/users/me - Should return 404 for non-existent user</td>
<td class="success">testUpdateProfileNotFound()</td>
<td class="success">1.621s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">PUT /api/users/me - Should update profile with partial data</td>
<td class="success">testUpdateProfilePartial()</td>
<td class="success">0.166s</td>
<td class="success">passed</td>
</tr>
</table>
</div>
<div class="tab">
<h2>Standard output</h2>
<span class="code">
<pre>
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.7)

2025-12-24T09:24:13.594+03:00  INFO 96902 --- [user-service] [    Test worker] r.i.u.controller.UserControllerTest      : The following 1 profile is active: &quot;test&quot;
2025-12-24T09:24:17.457+03:00  WARN 96902 --- [user-service] [    Test worker] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
2025-12-24T09:24:18.123+03:00  INFO 96902 --- [user-service] [    Test worker] r.i.u.controller.UserControllerTest      : Started UserControllerTest in 5.174 seconds (process running for 43.042)
2025-12-24T09:24:18.130+03:00  WARN 96902 --- [user-service] [    Test worker] o.s.core.events.SpringDocAppInitializer  : SpringDoc /v3/api-docs endpoint is enabled by default. To disable it in production, set the property 'springdoc.api-docs.enabled=false'
2025-12-24T09:24:18.130+03:00  WARN 96902 --- [user-service] [    Test worker] o.s.core.events.SpringDocAppInitializer  : SpringDoc /swagger-ui.html endpoint is enabled by default. To disable it in production, set the property 'springdoc.swagger-ui.enabled=false'
2025-12-24T09:24:20.826+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

&gt; POST /api/users/register
&gt; WebTestClient-Request-Id: [6]
&gt; Content-Type: [application/json]
&gt; Content-Length: [113]

{&quot;username&quot;:&quot;testuser&quot;,&quot;email&quot;:&quot;test2@example.com&quot;,&quot;password&quot;:&quot;Password123&quot;,&quot;firstName&quot;:&quot;Test&quot;,&quot;lastName&quot;:&quot;User&quot;}

&lt; 500 INTERNAL_SERVER_ERROR Internal Server Error
&lt; Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
&lt; Content-Type: [application/json]
&lt; Content-Length: [124]

{&quot;message&quot;:&quot;Username already taken: testuser&quot;,&quot;status&quot;:500,&quot;timestamp&quot;:&quot;2025-12-24T09:24:20.799792&quot;,&quot;path&quot;:&quot;&quot;,&quot;errors&quot;:null}

2025-12-24T09:24:21.389+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

&gt; POST /api/users/register
&gt; WebTestClient-Request-Id: [11]
&gt; Content-Type: [application/json]
&gt; Content-Length: [113]

{&quot;username&quot;:&quot;testuser2&quot;,&quot;email&quot;:&quot;test@example.com&quot;,&quot;password&quot;:&quot;Password123&quot;,&quot;firstName&quot;:&quot;Test&quot;,&quot;lastName&quot;:&quot;User&quot;}

&lt; 500 INTERNAL_SERVER_ERROR Internal Server Error
&lt; Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
&lt; Content-Type: [application/json]
&lt; Content-Length: [134]

{&quot;message&quot;:&quot;Email already registered: test@example.com&quot;,&quot;status&quot;:500,&quot;timestamp&quot;:&quot;2025-12-24T09:24:21.380996&quot;,&quot;path&quot;:&quot;&quot;,&quot;errors&quot;:null}

2025-12-24T09:24:21.692+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

&gt; PUT /api/users/me?userId=8
&gt; WebTestClient-Request-Id: [13]
&gt; Content-Type: [application/json]
&gt; Content-Length: [62]

{&quot;email&quot;:&quot;test1@example.com&quot;,&quot;firstName&quot;:null,&quot;lastName&quot;:null}

&lt; 500 INTERNAL_SERVER_ERROR Internal Server Error
&lt; Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
&lt; Content-Type: [application/json]
&lt; Content-Length: [134]

{&quot;message&quot;:&quot;Email already registered: test1@example.com&quot;,&quot;status&quot;:500,&quot;timestamp&quot;:&quot;2025-12-24T09:24:21.68989&quot;,&quot;path&quot;:&quot;&quot;,&quot;errors&quot;:null}

2025-12-24T09:24:21.885+03:00 ERROR 96902 --- [user-service] [    Test worker] o.s.t.w.reactive.server.ExchangeResult   : Request details for assertion failure:

&gt; POST /api/users/register
&gt; WebTestClient-Request-Id: [15]
&gt; Content-Type: [application/json]
&gt; Content-Length: [106]

{&quot;username&quot;:&quot;testuser&quot;,&quot;email&quot;:&quot;test@example.com&quot;,&quot;password&quot;:&quot;short&quot;,&quot;firstName&quot;:&quot;Test&quot;,&quot;lastName&quot;:&quot;User&quot;}

&lt; 500 INTERNAL_SERVER_ERROR Internal Server Error
&lt; Vary: [Origin, Access-Control-Request-Method, Access-Control-Request-Headers]
&lt; Content-Type: [application/json]
&lt; Content-Length: [802]

{&quot;message&quot;:&quot;Validation failed for argument at index 0 in method: public reactor.core.publisher.Mono&lt;org.springframework.http.ResponseEntity&lt;ru.itmo.userservice.model.dto.response.UserResponse&gt;&gt; ru.itmo.userservice.controller.UserController.register(ru.itmo.userservice.model.dto.request.RegisterRequest), with 1 error(s): [Field error in object 'registerRequest' on field 'password': rejected value [short]; codes [Size.registerRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.password,password]; arguments []; default message [password],72,8]; default message [Password must be between 8 and 72 characters]] &quot;,&quot;status&quot;:500,&quot;timestamp&quot;:&quot;2025-12-24T09:24:21.882881&quot;,&quot;path&quot;:&quot;&quot;,&quot;errors&quot;:null}

</pre>
</span>
</div>
</div>
<div id="footer">
<p>
<div>
<label class="hidden" id="label-for-line-wrapping-toggle" for="line-wrapping-toggle">Wrap lines
<input id="line-wrapping-toggle" type="checkbox" autocomplete="off"/>
</label>
</div>Generated by 
<a href="https://www.gradle.org">Gradle 8.13</a> at 24 дек. 2025 г., 09:24:31</p>
</div>
</div>
</body>
</html>
